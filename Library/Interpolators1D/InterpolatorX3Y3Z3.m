classdef InterpolatorX3Y3Z3  < Interpolator

    properties
        
        
    end
    
    methods
        function N = eval_N(obj, localcoords)
            xi = localcoords(1); eta = localcoords(2); zeta = localcoords(3);
            N = [ xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), -eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), -xi*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), -xi*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), -eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), -xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), eta*(eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), -xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), xi*(xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), -(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), xi*(xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), -xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), eta*(eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), -xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), -eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), -xi*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), -xi*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2), -eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2)];
        end
        
        function [dNdx, detJ] = eval_dNdx(obj, localcoords, ex, ey, ez)
            xi = localcoords(1); eta = localcoords(2); zeta = localcoords(3);

            dNdxi =...
            [ (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2),       - eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1) - eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (xi*zeta*(zeta/2 - 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1),       zeta*(zeta/2 - 1/2)*(xi - 1)*(eta - 1)*(eta + 1) + zeta*(zeta/2 - 1/2)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(zeta/2 - 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2),       - eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1) - eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (xi*eta*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1),       eta*(eta/2 - 1/2)*(xi - 1)*(zeta - 1)*(zeta + 1) + eta*(eta/2 - 1/2)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), (xi*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1))/2 + (xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi - 1)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1) - (xi + 1)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), (xi*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1))/2 + (xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1),       eta*(eta/2 + 1/2)*(xi - 1)*(zeta - 1)*(zeta + 1) + eta*(eta/2 + 1/2)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2),       - eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1) - eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (xi*zeta*(zeta/2 + 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1),       zeta*(zeta/2 + 1/2)*(xi - 1)*(eta - 1)*(eta + 1) + zeta*(zeta/2 + 1/2)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(zeta/2 + 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2),       - eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1) - eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2);...
                (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (eta*zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2),       - xi*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1) - xi*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta + 1),       zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta - 1) + zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta + 1),       - xi*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1) - xi*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (eta*zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (xi*eta*(xi/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), (eta*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1))/2 + (eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(xi/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1),       xi*(xi/2 - 1/2)*(eta - 1)*(zeta - 1)*(zeta + 1) + xi*(xi/2 - 1/2)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi - 1)*(xi + 1)*(eta - 1)*(zeta - 1)*(zeta + 1) - (xi - 1)*(xi + 1)*(eta + 1)*(zeta - 1)*(zeta + 1),       xi*(xi/2 + 1/2)*(eta - 1)*(zeta - 1)*(zeta + 1) + xi*(xi/2 + 1/2)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(xi/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), (eta*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1))/2 + (eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(xi/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (eta*zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2),       - xi*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1) - xi*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta + 1),       zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta - 1) + zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta + 1),       - xi*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1) - xi*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2), - (eta*zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2);...
                (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (eta*zeta*(eta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (xi*zeta*(xi/2 - 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), (zeta*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1))/2 + (zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(xi/2 + 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (eta*zeta*(eta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2),       - xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1) - xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta + 1),       eta*(eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta - 1) + eta*(eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta + 1),       - xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1) - xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta + 1),       xi*(xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta - 1) + xi*(xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta + 1), - (xi - 1)*(xi + 1)*(eta - 1)*(eta + 1)*(zeta - 1) - (xi - 1)*(xi + 1)*(eta - 1)*(eta + 1)*(zeta + 1),       xi*(xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta - 1) + xi*(xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta + 1),       - xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1) - xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta + 1),       eta*(eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta - 1) + eta*(eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta + 1),       - xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1) - xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (eta*zeta*(eta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (xi*zeta*(xi/2 - 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), (zeta*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1))/2 + (zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(xi/2 + 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2), - (eta*zeta*(eta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2)];

            %Jacobian transpose
            JT = dNdxi*[ex', ey', ez'];
            detJ=det(JT);
            if (detJ<0)
                error('Jacobian not invertable')
            end
            
            %Derivatives of x and y
            dNdx = JT\dNdxi;
        end
        
    end
    
end



% [ xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), -eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), -xi*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), -xi*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), -eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), -xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), eta*(eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), -xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), xi*(xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), -(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), xi*(xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), -xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), eta*(eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), -xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), -eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), -xi*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), -xi*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2), -eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2)]
% 
% 
% [ (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2),       - eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1) - eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (xi*zeta*(zeta/2 - 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1),       zeta*(zeta/2 - 1/2)*(xi - 1)*(eta - 1)*(eta + 1) + zeta*(zeta/2 - 1/2)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(zeta/2 - 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2),       - eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1) - eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 - 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (xi*eta*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1),       eta*(eta/2 - 1/2)*(xi - 1)*(zeta - 1)*(zeta + 1) + eta*(eta/2 - 1/2)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), (xi*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1))/2 + (xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi - 1)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1) - (xi + 1)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), (xi*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1))/2 + (xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1),       eta*(eta/2 + 1/2)*(xi - 1)*(zeta - 1)*(zeta + 1) + eta*(eta/2 + 1/2)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2),       - eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1) - eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 - 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (xi*zeta*(zeta/2 + 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1),       zeta*(zeta/2 + 1/2)*(xi - 1)*(eta - 1)*(eta + 1) + zeta*(zeta/2 + 1/2)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(zeta/2 + 1/2)*(eta - 1)*(eta + 1))/2 - zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2),       - eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1) - eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi + 1), (xi*eta*zeta*(eta/2 + 1/2)*(zeta/2 + 1/2))/2 + eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2);...
%  (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (eta*zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2),       - xi*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1) - xi*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta + 1),       zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta - 1) + zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta + 1),       - xi*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1) - xi*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (eta*zeta*(zeta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 - 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (xi*eta*(xi/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1), (eta*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1))/2 + (eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(xi/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1)*(zeta + 1),       xi*(xi/2 - 1/2)*(eta - 1)*(zeta - 1)*(zeta + 1) + xi*(xi/2 - 1/2)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi - 1)*(xi + 1)*(eta - 1)*(zeta - 1)*(zeta + 1) - (xi - 1)*(xi + 1)*(eta + 1)*(zeta - 1)*(zeta + 1),       xi*(xi/2 + 1/2)*(eta - 1)*(zeta - 1)*(zeta + 1) + xi*(xi/2 + 1/2)*(eta + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(xi/2 - 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), (eta*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1))/2 + (eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta - 1)*(zeta + 1), - (xi*eta*(xi/2 + 1/2)*(zeta - 1)*(zeta + 1))/2 - xi*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1)*(zeta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (eta*zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2),       - xi*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1) - xi*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta + 1),       zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta - 1) + zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta + 1),       - xi*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1) - xi*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2), - (eta*zeta*(zeta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - zeta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(zeta/2 + 1/2))/2 + xi*zeta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2);...
%  (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (eta*zeta*(eta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 - 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 - 1/2), - (xi*zeta*(xi/2 - 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 - 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), (zeta*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1))/2 + (zeta/2 - 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(xi/2 + 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 + 1/2)*(zeta/2 - 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2), - (eta*zeta*(eta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 + 1/2)*(zeta/2 - 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 - 1/2),       - xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta - 1) - xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta + 1),       eta*(eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta - 1) + eta*(eta/2 - 1/2)*(xi - 1)*(xi + 1)*(zeta + 1),       - xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta - 1) - xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta + 1),       xi*(xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta - 1) + xi*(xi/2 - 1/2)*(eta - 1)*(eta + 1)*(zeta + 1), - (xi - 1)*(xi + 1)*(eta - 1)*(eta + 1)*(zeta - 1) - (xi - 1)*(xi + 1)*(eta - 1)*(eta + 1)*(zeta + 1),       xi*(xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta - 1) + xi*(xi/2 + 1/2)*(eta - 1)*(eta + 1)*(zeta + 1),       - xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta - 1) - xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta + 1),       eta*(eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta - 1) + eta*(eta/2 + 1/2)*(xi - 1)*(xi + 1)*(zeta + 1),       - xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta - 1) - xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (eta*zeta*(eta/2 - 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 - 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 - 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 - 1/2)*(zeta/2 + 1/2), - (xi*zeta*(xi/2 - 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 - 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), (zeta*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1))/2 + (zeta/2 + 1/2)*(xi - 1)*(xi + 1)*(eta - 1)*(eta + 1), - (xi*zeta*(xi/2 + 1/2)*(eta - 1)*(eta + 1))/2 - xi*(xi/2 + 1/2)*(zeta/2 + 1/2)*(eta - 1)*(eta + 1), (xi*eta*zeta*(xi/2 - 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 - 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2), - (eta*zeta*(eta/2 + 1/2)*(xi - 1)*(xi + 1))/2 - eta*(eta/2 + 1/2)*(zeta/2 + 1/2)*(xi - 1)*(xi + 1), (xi*eta*zeta*(xi/2 + 1/2)*(eta/2 + 1/2))/2 + xi*eta*(xi/2 + 1/2)*(eta/2 + 1/2)*(zeta/2 + 1/2)];
